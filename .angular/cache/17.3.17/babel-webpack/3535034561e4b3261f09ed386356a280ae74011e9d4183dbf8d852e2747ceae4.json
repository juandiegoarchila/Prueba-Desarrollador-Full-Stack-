{"ast":null,"code":"import { Observable } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../storage/storage.service\";\nexport let LocalAuthRepository = /*#__PURE__*/(() => {\n  class LocalAuthRepository {\n    constructor(storage) {\n      this.storage = storage;\n      this.USER_KEY = 'current_user';\n      this.USERS_DB_KEY = 'local_users_db'; // Mock users list\n    }\n    login(email, password) {\n      // Mock login logic\n      return new Observable(observer => {\n        this.storage.get(this.USERS_DB_KEY).then(users => {\n          const user = (users || []).find(u => u.email === email && u.password === password);\n          if (user) {\n            const safeUser = {\n              uid: user.uid,\n              email: user.email,\n              displayName: user.displayName\n            };\n            this.storage.set(this.USER_KEY, safeUser);\n            observer.next(safeUser);\n            observer.complete();\n          } else {\n            observer.error('Credenciales inválidas (Local)');\n          }\n        });\n      });\n    }\n    register(name, email, password) {\n      return new Observable(observer => {\n        this.storage.get(this.USERS_DB_KEY).then(users => {\n          const currentUsers = users || [];\n          const exists = currentUsers.find(u => u.email === email);\n          if (exists) {\n            observer.error('El usuario ya existe');\n            return;\n          }\n          const newUser = {\n            uid: 'local_' + new Date().getTime(),\n            email,\n            password,\n            displayName: name\n          };\n          currentUsers.push(newUser);\n          this.storage.set(this.USERS_DB_KEY, currentUsers);\n          const safeUser = {\n            uid: newUser.uid,\n            email: newUser.email,\n            displayName: newUser.displayName\n          };\n          this.storage.set(this.USER_KEY, safeUser);\n          observer.next(safeUser);\n          observer.complete();\n        });\n      });\n    }\n    logout() {\n      return this.storage.remove(this.USER_KEY).then(() => {});\n    }\n    getCurrentUser() {\n      return new Observable(observer => {\n        this.storage.get(this.USER_KEY).then(user => {\n          observer.next(user || null);\n          observer.complete();\n        });\n      });\n    }\n    resetPassword(email) {\n      return new Promise((resolve, reject) => {\n        // Simulación: Verificar si el correo existe en la \"base de datos\" local\n        this.storage.get(this.USERS_DB_KEY).then(users => {\n          const user = (users || []).find(u => u.email === email);\n          if (user) {\n            // Simular éxito\n            console.log(`[LocalAuth] Email de restablecimiento enviado a ${email}`);\n            resolve();\n          } else {\n            reject(new Error('No se encontró una cuenta con este correo electrónico.'));\n          }\n        });\n      });\n    }\n    static {\n      this.ɵfac = function LocalAuthRepository_Factory(t) {\n        return new (t || LocalAuthRepository)(i0.ɵɵinject(i1.StorageService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: LocalAuthRepository,\n        factory: LocalAuthRepository.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return LocalAuthRepository;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}