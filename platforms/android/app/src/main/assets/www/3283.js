"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3283],{3283:($,g,c)=>{c.r(g),c.d(g,{CartPageModule:()=>T});var l=c(177),r=c(8974),f=c(253),u=c(467),t=c(4438);function _(e,s){if(1&e&&(t.j41(0,"div",9)(1,"div",10)(2,"span"),t.EFF(3,"Subtotal (Base)"),t.k0s(),t.j41(4,"span"),t.EFF(5),t.nI1(6,"currency"),t.k0s()(),t.j41(7,"div",10)(8,"span"),t.EFF(9,"IVA (19%)"),t.k0s(),t.j41(10,"span"),t.EFF(11),t.nI1(12,"currency"),t.k0s()(),t.j41(13,"div",10)(14,"span"),t.EFF(15,"Env\xedo"),t.k0s(),t.j41(16,"span",11),t.EFF(17,"Gratis"),t.k0s()(),t.nrm(18,"div",12),t.j41(19,"div",13)(20,"span"),t.EFF(21,"Total a pagar:"),t.k0s(),t.j41(22,"span",14),t.EFF(23),t.nI1(24,"currency"),t.k0s()()()),2&e){const n=t.XpG();t.R7$(5),t.JRh(t.ii3(6,3,n.total/1.19,"COP","symbol","1.0-0")),t.R7$(6),t.JRh(t.ii3(12,8,n.total-n.total/1.19,"COP","symbol","1.0-0")),t.R7$(12),t.JRh(t.ii3(24,13,n.total,"COP","symbol","1.0-0"))}}let h=(()=>{class e{constructor(n){this.modalCtrl=n,this.title="Confirmaci\xf3n",this.message="\xbfEst\xe1s seguro de realizar esta acci\xf3n?",this.total=0}cancel(){this.modalCtrl.dismiss({confirmed:!1},"cancel")}confirm(){this.modalCtrl.dismiss({confirmed:!0},"confirm")}static{this.\u0275fac=function(i){return new(i||e)(t.rXU(r.W3))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-confirmation-modal"]],inputs:{title:"title",message:"message",total:"total"},decls:13,vars:3,consts:[[1,"modal-wrapper","ion-padding"],[1,"icon-header","ion-text-center"],["name","help-circle-outline","color","primary"],[1,"text-bold","ion-text-center"],[1,"text-medium","text-muted","ion-text-center"],["class","order-summary-box",4,"ngIf"],[1,"actions"],["expand","block","fill","outline","color","medium",1,"action-btn",3,"click"],["expand","block","color","primary",1,"action-btn",3,"click"],[1,"order-summary-box"],[1,"summary-line"],[1,"free-text"],[1,"separator"],[1,"total-line"],[1,"total-val"]],template:function(i,o){1&i&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"ion-icon",2),t.k0s(),t.j41(3,"h2",3),t.EFF(4),t.k0s(),t.j41(5,"p",4),t.EFF(6),t.k0s(),t.DNE(7,_,25,18,"div",5),t.j41(8,"div",6)(9,"ion-button",7),t.bIt("click",function(){return o.cancel()}),t.EFF(10," Cancelar "),t.k0s(),t.j41(11,"ion-button",8),t.bIt("click",function(){return o.confirm()}),t.EFF(12," Confirmar "),t.k0s()()()),2&i&&(t.R7$(4),t.JRh(o.title),t.R7$(2),t.JRh(o.message),t.R7$(),t.Y8G("ngIf",o.total>0))},dependencies:[l.bT,r.Jm,r.iq,l.oe],styles:[".modal-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding-top:30px}.icon-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:60px;margin-bottom:10px}h2[_ngcontent-%COMP%]{margin:0 0 10px;color:var(--ion-color-tertiary)}p[_ngcontent-%COMP%]{margin:0 0 20px;line-height:1.5}.order-summary-box[_ngcontent-%COMP%]{width:100%;background:#f8f9fa;padding:15px;border-radius:12px;margin-bottom:25px}.summary-line[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:5px;font-size:13px;color:#6c757d}.free-text[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:700}.separator[_ngcontent-%COMP%]{height:1px;background:#dee2e6;margin:8px 0}.total-line[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:700;color:var(--ion-color-dark);font-size:15px}.actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:15px;width:100%}.action-btn[_ngcontent-%COMP%]{margin:0;--box-shadow: none;font-weight:600}"]})}}return e})();var v=c(6042),x=c(1935),C=c(5182),b=c(4517),y=c(5567),k=c(8245),P=c(5577);function F(e,s){if(1&e){const n=t.RV6();t.j41(0,"ion-item-sliding",10)(1,"ion-item",11)(2,"ion-thumbnail",12),t.nrm(3,"img",13),t.k0s(),t.j41(4,"ion-label",14)(5,"div",15)(6,"h3",16),t.EFF(7),t.k0s(),t.j41(8,"span",17),t.EFF(9),t.nI1(10,"currency"),t.k0s()(),t.j41(11,"div",18)(12,"ion-button",19),t.bIt("click",function(){const o=t.eBV(n).$implicit,a=t.XpG(3);return t.Njj(a.updateQty(o.product.id,o.quantity-1))}),t.nrm(13,"ion-icon",20),t.k0s(),t.j41(14,"span",21),t.EFF(15),t.k0s(),t.j41(16,"ion-button",19),t.bIt("click",function(){const o=t.eBV(n).$implicit,a=t.XpG(3);return t.Njj(a.updateQty(o.product.id,o.quantity+1))}),t.nrm(17,"ion-icon",22),t.k0s(),t.j41(18,"ion-button",23),t.bIt("click",function(){const o=t.eBV(n).$implicit,a=t.XpG(3);return t.Njj(a.removeItem(o.product.id))}),t.nrm(19,"ion-icon",24),t.k0s()()()(),t.j41(20,"ion-item-options",25)(21,"ion-item-option",26),t.bIt("click",function(){const o=t.eBV(n).$implicit,a=t.XpG(3);return t.Njj(a.removeItem(o.product.id))}),t.nrm(22,"ion-icon",27),t.k0s()()()}if(2&e){const n=s.$implicit;t.R7$(3),t.Y8G("src",n.product.imageUrl,t.B4B),t.R7$(4),t.JRh(n.product.name),t.R7$(2),t.JRh(t.ii3(10,4,n.total,"COP","symbol","1.0-0")),t.R7$(6),t.JRh(n.quantity)}}function j(e,s){if(1&e&&(t.j41(0,"div")(1,"ion-list",8),t.DNE(2,F,23,9,"ion-item-sliding",9),t.k0s()()),2&e){const n=t.XpG().ngIf;t.R7$(2),t.Y8G("ngForOf",n)}}function I(e,s){if(1&e){const n=t.RV6();t.j41(0,"app-empty-state",28),t.bIt("action",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.goToCatalog())}),t.k0s()}}function O(e,s){if(1&e&&(t.j41(0,"div"),t.DNE(1,j,3,1,"div",7)(2,I,1,0,"ng-template",null,0,t.C5r),t.k0s()),2&e){const n=s.ngIf,i=t.sdS(3);t.R7$(),t.Y8G("ngIf",n.length>0)("ngIfElse",i)}}function M(e,s){if(1&e){const n=t.RV6();t.j41(0,"div",31)(1,"div",32)(2,"div",33)(3,"span"),t.EFF(4,"Subtotal (Base)"),t.k0s(),t.j41(5,"span"),t.EFF(6),t.nI1(7,"currency"),t.k0s()(),t.j41(8,"div",33)(9,"span"),t.EFF(10,"IVA (19%)"),t.k0s(),t.j41(11,"span"),t.EFF(12),t.nI1(13,"currency"),t.k0s()(),t.j41(14,"div",33)(15,"span"),t.EFF(16,"Env\xedo"),t.k0s(),t.j41(17,"span",34),t.EFF(18,"Gratis"),t.k0s()()(),t.nrm(19,"div",35),t.j41(20,"div",36)(21,"span",37),t.EFF(22,"Total a pagar:"),t.k0s(),t.j41(23,"span",38),t.EFF(24),t.nI1(25,"currency"),t.k0s()(),t.j41(26,"ion-button",39),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.checkout())}),t.EFF(27," FINALIZAR COMPRA "),t.nrm(28,"ion-icon",40),t.k0s()()}if(2&e){const n=t.XpG().ngIf;t.R7$(6),t.JRh(t.ii3(7,3,n/1.19,"COP","symbol","1.0-0")),t.R7$(6),t.JRh(t.ii3(13,8,n-n/1.19,"COP","symbol","1.0-0")),t.R7$(12),t.JRh(t.ii3(25,13,n,"COP","symbol","1.0-0"))}}function E(e,s){if(1&e&&(t.j41(0,"ion-footer",29),t.DNE(1,M,29,18,"div",30),t.k0s()),2&e){const n=s.ngIf;t.R7$(),t.Y8G("ngIf",n>0)}}let w=(()=>{class e{constructor(n,i,o,a,m,d,p){this.cartService=n,this.auth=i,this.orderService=o,this.nav=a,this.modalCtrl=m,this.notify=d,this.loadingCtrl=p,this.cartItems$=this.cartService.cart$,this.total$=this.cartService.total$}updateQty(n,i){i<=0?this.removeItem(n):this.cartService.updateQuantity(n,i)}removeItem(n){this.cartService.removeFromCart(n),this.notify.showWarning("Producto eliminado")}confirmClear(){this.cartService.clearCart(),this.notify.showInfo("Carrito vaciado")}goToCatalog(){this.nav.navigateBack("/catalog")}checkout(){var n=this;return(0,u.A)(function*(){if(!n.auth.isAuthenticated())return n.notify.showInfo("Debes iniciar sesi\xf3n para finalizar tu compra"),void n.nav.navigateForward("/login");const o=n.cartService.getCurrentValue().reduce((d,p)=>d+p.total,0),a=yield n.modalCtrl.create({component:h,componentProps:{title:"Confirmar Pedido",message:"\xbfEst\xe1s seguro de que deseas procesar la compra?",total:o},cssClass:"small-modal"});yield a.present();const{data:m}=yield a.onWillDismiss();m&&m.confirmed&&n.processOrder()})()}processOrder(){var n=this;return(0,u.A)(function*(){const i=yield n.loadingCtrl.create({message:"Procesando tu pedido...",duration:5e3});yield i.present();const o=n.cartService.getCurrentValue(),a=o.reduce((d,p)=>d+p.total,0),m={id:Date.now().toString(),items:o,total:a,date:new Date,status:"pending",userId:n.auth.currentUserValue?.uid||"1"};n.orderService.createOrder(m).subscribe({next:()=>{i.dismiss(),n.cartService.clearCart(),n.notify.showSuccess("\xa1Pedido realizado con \xe9xito!"),n.nav.navigateRoot("/confirm")},error:d=>{i.dismiss(),console.error("Order creation failed",d),n.notify.showError("Hubo un problema al crear el pedido.")}})})()}static{this.\u0275fac=function(i){return new(i||e)(t.rXU(v.m),t.rXU(x.u),t.rXU(C.Q),t.rXU(b.q9),t.rXU(r.W3),t.rXU(y.J),t.rXU(r.Xi))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-cart"]],decls:9,vars:7,consts:[["emptyCart",""],["title","Tu Carrito",3,"backButton"],["fill","clear","color","light",3,"click"],["name","arrow-back-circle-outline","slot","start"],["color","light",1,"ion-padding"],[4,"ngIf"],["class","ion-no-border shadow-card",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"cart-list","ion-no-padding"],["class","cart-item",4,"ngFor","ngForOf"],[1,"cart-item"],["lines","none",1,"item-inner"],["slot","start",1,"rounded-thumb"],[3,"src"],[1,"ion-text-wrap"],[1,"header-flex"],[1,"text-bold","text-dark","product-name"],[1,"text-bold","text-dark","item-price"],[1,"stepper"],["size","small","fill","outline","color","medium",1,"stepper-btn",3,"click"],["name","remove","slot","icon-only"],[1,"qty-label"],["name","add","slot","icon-only"],["size","small","fill","clear","color","danger",1,"trash-btn",3,"click"],["name","trash-outline","slot","icon-only"],["side","end"],["color","danger",3,"click"],["name","trash","slot","icon-only"],["title","Carrito vac\xedo","description","Aqu\xed ver\xe1s los productos que selecciones.","icon","cart-outline","actionText","Ir al cat\xe1logo",3,"action"],[1,"ion-no-border","shadow-card"],["class","footer-container",4,"ngIf"],[1,"footer-container"],[1,"order-summary"],[1,"summary-row"],[1,"free-badge"],[1,"divider"],[1,"total-row"],[1,"text-medium","text-muted"],[1,"text-bold","text-large"],["expand","block","shape","round","color","success",1,"checkout-btn",3,"click"],["name","arrow-forward","slot","end"]],template:function(i,o){1&i&&(t.j41(0,"app-header",1)(1,"ion-button",2),t.bIt("click",function(){return o.goToCatalog()}),t.nrm(2,"ion-icon",3),t.EFF(3," Volver "),t.k0s()(),t.j41(4,"ion-content",4),t.DNE(5,O,4,2,"div",5),t.nI1(6,"async"),t.k0s(),t.DNE(7,E,2,1,"ion-footer",6),t.nI1(8,"async")),2&i&&(t.Y8G("backButton",!0),t.R7$(5),t.Y8G("ngIf",t.bMT(6,3,o.cartItems$)),t.R7$(2),t.Y8G("ngIf",t.bMT(8,5,o.total$)))},dependencies:[l.Sq,l.bT,r.Jm,r.W9,r.M0,r.iq,r.uz,r.LU,r.CE,r.A7,r.he,r.nf,r.Zx,k.y,P.o,l.Jj,l.oe],styles:[".cart-list[_ngcontent-%COMP%]{background:transparent}.cart-item[_ngcontent-%COMP%]{margin-bottom:15px;border-radius:12px;background:#fff;box-shadow:0 4px 12px #0000000d;overflow:hidden}.item-inner[_ngcontent-%COMP%]{--background: white;--inner-padding-end: 10px}.rounded-thumb[_ngcontent-%COMP%]{--border-radius: 10px}.text-dark[_ngcontent-%COMP%]{color:var(--ion-color-tertiary)}.text-bold[_ngcontent-%COMP%]{font-weight:800}.header-flex[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:flex-start;gap:8px;margin-bottom:8px}.product-name[_ngcontent-%COMP%]{margin:0;font-size:14px;line-height:1.25;flex:1 1 140px}.item-price[_ngcontent-%COMP%]{font-size:15px;color:var(--ion-color-tertiary);white-space:nowrap}.stepper[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:8px;gap:5px}.qty-label[_ngcontent-%COMP%]{font-weight:600;min-width:20px;text-align:center;font-size:14px}.stepper-btn[_ngcontent-%COMP%]{height:28px;--padding-start: 4px;--padding-end: 4px;min-width:32px;margin:0}.trash-btn[_ngcontent-%COMP%]{height:28px;width:30px;--padding-start: 0;--padding-end: 0;margin-left:5px}.total-column[_ngcontent-%COMP%]{display:none}.footer-container[_ngcontent-%COMP%]{background:#fff;padding:12px 16px 20px;box-shadow:0 -5px 20px #0000000d;border-radius:20px 20px 0 0}.order-summary[_ngcontent-%COMP%]{margin-bottom:5px}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:2px;font-size:13px;color:var(--ion-color-medium)}.free-badge[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:700}.divider[_ngcontent-%COMP%]{height:1px;background:#f0f0f0;margin:8px 0 12px}.total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.text-large[_ngcontent-%COMP%]{font-size:1.3rem;color:var(--ion-color-tertiary)}.checkout-btn[_ngcontent-%COMP%]{height:45px;--box-shadow: 0 8px 20px rgba(0, 184, 148, .3);font-weight:700;letter-spacing:.5px}"]})}}return e})();var R=c(3887);let T=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=t.$C({type:e})}static{this.\u0275inj=t.G2t({imports:[l.MD,r.bv,R.G,f.iI.forChild([{path:"",component:w}])]})}}return e})()}}]);